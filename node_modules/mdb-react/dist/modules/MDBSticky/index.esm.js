import t from"clsx";import n,{useRef as e,useState as o,useCallback as c,useEffect as i}from"react";var r=function(){return r=Object.assign||function(t){for(var n,e=1,o=arguments.length;e<o;e++)for(var c in n=arguments[e])Object.prototype.hasOwnProperty.call(n,c)&&(t[c]=n[c]);return t},r.apply(this,arguments)};function l(t){var n=function(t){var n=t.getBoundingClientRect();return{top:n.top+document.body.scrollTop,left:n.left+document.body.scrollLeft}}(t),e=t.getBoundingClientRect(),o=0===n.left&&0===n.top?0:window.innerHeight-e.bottom;return r(r({},n),{bottom:o})}var u=function(u){var a=u.className,s=u.stickyRef,f=u.stickyAnimationSticky,p=u.stickyAnimationUnsticky,y=u.stickyBoundary,d=u.stickyDelay,m=u.stickyDirection,h=u.stickyOffset,g=u.stickyPosition,k=u.tag,b=u.children,v=function(t,n){var e={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&n.indexOf(o)<0&&(e[o]=t[o]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var c=0;for(o=Object.getOwnPropertySymbols(t);c<o.length;c++)n.indexOf(o[c])<0&&Object.prototype.propertyIsEnumerable.call(t,o[c])&&(e[o[c]]=t[o[c]])}return e}(u,["className","stickyRef","stickyAnimationSticky","stickyAnimationUnsticky","stickyBoundary","stickyDelay","stickyDirection","stickyOffset","stickyPosition","tag","children"]),w=e(null),x=e(null),O=s||w,E=e(""),B=e(!1),P=e(0),R=e(0),j=e(0),A=o(),C=A[0],D=A[1],S=o(),z=S[0],L=S[1],T=o(!1),I=T[0],N=T[1],U=o({}),H=U[0],q=U[1],F=o(!1),Y=F[0],G=F[1],J=t("sticky",f&&I&&"animation ".concat(f),p&&Y&&"animation ".concat(p),a),K=c((function(){var t=x.current,n=O.current;P.current=t?t.offsetTop:n.offsetTop}),[O]),M=c((function(){var t=O.current;t&&(j.current="top"===g?P.current-d:P.current+t.height-document.body.scrollHeight+d)}),[d,g,O]),Q=c((function(t){t>R.current?E.current="down":E.current="up"}),[]),V=function(t,n){Object.keys(n).forEach((function(e){t.style[e]=n[e]}))},W=c((function(){var t=x.current,n=O.current;if(t){var e=t.getBoundingClientRect().left;q({left:"".concat(e,"px")})}else q({});V(n,H),K()}),[K,H,O]),X=c((function(){var t,n=O.current,e=n.getBoundingClientRect().height,o=r({height:n.parentElement.getBoundingClientRect().height},l(n.parentElement)),c=document.querySelector(y);t=c?l(c).top-e-h:o.height+o[g]-e-h;var i,u="top"===g,a="bottom"===g,s=y,f=t<0,p=t>o.height-e;u&&(i=f&&s?{top:"".concat(h+t,"px")}:{top:"".concat(h+0,"px")}),a&&(i=f&&s?{bottom:"".concat(h+t,"px")}:p&&s?{bottom:"".concat(h+o.bottom,"px")}:{bottom:"".concat(h+0,"px")}),V(n,i)}),[y,h,g,O]),Z=c((function(){var t=window.pageYOffset||document.documentElement.scrollTop;K(),M(),Q(t);var n=[E.current,"both"].includes(m),e=j.current<=t,o=e&&!B.current&&n,c=(!e||!n)&&B.current;if(o){var i=O.current.getBoundingClientRect(),r=i.height,l=i.left,u=i.width;N(!0),L({height:"".concat(r,"px"),width:"".concat(u,"px"),opacity:"0"}),D({top:"top"===g?"".concat(0+h,"px"):null,bottom:"bottom"===g?"".concat(0+h,"px"):null,height:"".concat(r,"px"),width:"".concat(u,"px"),left:"".concat(l,"px"),zIndex:"100",position:"fixed"}),X(),B.current=!0}c&&(p?(G(!0),setTimeout((function(){D({top:null,bottom:null,position:null,left:null,zIndex:null,width:null,height:null}),N(!1),L({height:null,width:null,opacity:null}),G(!1)}),200)):(D({top:null,bottom:null,position:null,left:null,zIndex:null,width:null,height:null}),N(!1),L({height:null,width:null,opacity:null})),B.current=!1),B.current&&(V(O.current,H),X()),R.current=t<=0?0:t}),[m,K,M,Q,h,g,O,H,X,p]);return i((function(){return window.addEventListener("resize",W),window.addEventListener("scroll",Z),function(){window.removeEventListener("resize",W),window.removeEventListener("scroll",Z)}}),[W,Z]),n.createElement(n.Fragment,null,I&&n.createElement(k,r({className:J,ref:x,style:z},v),b),n.createElement(k,r({className:J,ref:O,style:C},v),b))};u.defaultProps={stickyAnimationSticky:"",stickyAnimationUnsticky:"",tag:"span",stickyBoundary:!1,stickyDelay:0,stickyDirection:"down",stickyOffset:0,stickyPosition:"top"};export{u as default};
